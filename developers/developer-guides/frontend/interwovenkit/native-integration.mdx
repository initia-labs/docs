---
title: Native Integration
---

[Tutorial GitHub Repository](https://github.com/initia-labs/examples/tree/main/frontend/react-wallet-widget)

## Overview

In this guide, we will walk through the steps to integrate the Initia Wallet Widget into a NextJS project. The completed webapp will allow users to connect their Initia Wallet as well as other wallets and perform a simple token transfer transaction to their own wallet.

<Frame>
<video controls src="/videos/initia_wallet_widget/using_initia_wallet_widget.mp4" />
</Frame>

## Prerequisites

- [NodeJS](https://nodejs.org)

## Project setup

First, we need to create a new template directory for our NextJS project.

```sh
npx create-next-app@latest initia-wallet-widget
```

Select "**Yes**" for all of the configuration prompts except for "Would you like to customize the default import alias".

Once the project is created, navigate into the project directory and install the dependencies. For this tutorial, we will need to use 4 libraries:

- `@initia/interwovenkit-react`: A React library that provides all the components for the Initia Wallet Widget.
- `wagmi`: A React library for managing connections to EVM wallets.
- `@tanstack/react-query`: A data-fetching library for React.
- `cosmjs-types`: A javascript library that provides message definitions for interacting with Cosmos SDK-based blockchains.

```sh
cd initia-wallet-widget
npm install @initia/interwovenkit-react wagmi @tanstack/react-query cosmjs-types
```

<Info>
When the transaction modal unmounts, the transaction gets automatically rejected.  
If `StrictMode` is on, React renders the component twice, so the transaction might get rejected immediately.  
This only happens in development mode. To avoid it, you can temporarily disable `StrictMode`.  

```ts next.config.ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  reactStrictMode: false,
};

export default nextConfig;
```
</Info>

Once we have the project setup, we can start developing the frontend.

## Developing

### Creating a Provider component

First, we need to create a new **client component** that will inject the CSS styles required by the widget and wrap your application into `<WagmiProvider>`, `<QueryClientProvider>` and `<InterwovenKitProvider>`.

```tsx src/components/Providers.tsx
"use client"; // this is needed to make this a client component

import { useEffect, type PropsWithChildren } from "react";
// import the required dependencies
import { createConfig, http, WagmiProvider } from "wagmi";
import { mainnet } from "wagmi/chains";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { injectStyles, InterwovenKitProvider } from "@initia/interwovenkit-react";
import initiaWidgetStyles from "@initia/interwovenkit-react/styles.js";

// initialize wagmi and react-query
const wagmiConfig = createConfig({
  chains: [mainnet],
  transports: { [mainnet.id]: http() },
});
const queryClient = new QueryClient();


export default function Providers({ children }: PropsWithChildren) {
  // inject CSS styles for Initia Widget
  useEffect(() => {
    injectStyles(initiaWidgetStyles);
  }, []);

  // wrap your app with all the providers
  return (
    <WagmiProvider config={wagmiConfig}>
      <QueryClientProvider client={queryClient}>
        <InterwovenKitProvider>{children}</InterwovenKitProvider>
      </QueryClientProvider>
    </WagmiProvider>
  );
}
```

### Wrapping your app with the Provider

Then, we can wrap our project with the Provider component that we just created. This will allow us to use the hooks provided by Wallet Widget. 
To do so, we need to import the `Providers` component and wrap the `children` component in `src/app/layout.tsx` with it.

```tsx src/app/layout.tsx
import type { Metadata } from "next";
import Providers from "../components/Providers";

export const metadata: Metadata = {
  title: "Initia InterwovenKit Example",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body>
        <Providers>{children}</Providers>
      </body>
    </html>
  );
}
```

### Using the Wallet Widget

Once we have all the providers in place, we can use the `useInterwovenKit` hook to interact with the wallet. We will do this by modifying `src/app/page.tsx`.

First, we declare `use client` at the top of the file and import the necessary libraries and hooks.

```tsx src/app/page.tsx
'use client';

import { useState } from "react";
import { useInterwovenKit } from "@initia/interwovenkit-react";
import { MsgSend } from "cosmjs-types/cosmos/bank/v1beta1/tx";
```

- `useInterwovenKit`: The hook that we will use to interact with the widget
- `MsgSend`: A message type that is used to send tokens from one wallet to another.

Finally, we will implement the Home component that will house our webapp functionality. We begin by declaring the the necessary state variables.

```tsx src/app/page.tsx
const { address, openConnect, openWallet, requestTxBlock } = useInterwovenKit();
const [isLoading, setIsLoading] = useState(false);
const [transactionHash, setTransactionHash] = useState<string | null>(null);
```

- `address`: The Initia address of the connected wallet.
- `openConnect`: A function that we can use to open the wallet connect modal.
- `openWallet`: A function that allows us to open the wallet widget modal.
- `requestTxBlock`: A function that allows us to request a transaction from the wallet.
- `isLoading`: A state variable that indicates whether the transaction is being requested.
- `transactionHash`: A state variable that stores the transaction hash.

Then, we implement a `send` function that will send a transaction to the wallet. The function will check if the wallet is connected, and if it is, it will request a transaction to send 1000000 `uinit` (1 INIT) from the wallet to itself.

```tsx src/app/page.tsx
const send = async () => {
  if (!initiaAddress) return;

  setIsLoading(true);

  // create the MsgSend
  const messages = [
    {
      typeUrl: "/cosmos.bank.v1beta1.MsgSend",
      value: MsgSend.fromPartial({
        fromAddress: initiaAddress,
        toAddress: initiaAddress,
        amount: [{ amount: "1000000", denom: "uinit" }],
      }),
    },
  ];

  try {
    // sign and broadcast tx
    const { transactionHash: hash } = await requestTxBlock({ messages, memo: "Hello world!" });
    setTransactionHash(hash);
    console.log("Transaction successful: ", hash);
  } catch (error) {
    console.error("Transaction failed: ", error);
  } finally {
    setIsLoading(false);
  }
};
```

Finally, we return the component that will be exposed to the user. The example component below renders a simple user interface for wallet interaction:
- If no wallet is connected, it displays a "Connect" button.
- Once connected, it shows the user's address and a "Send 1 INIT" button.
- The send button triggers a transaction sending 1 INIT to the user's own address.
- After a successful transaction, it displays the transaction hash with a link to the block explorer.

```tsx src/app/page.tsx
return (
    <main className="flex min-h-screen flex-col items-center p-24 bg-white">
      <div className="z-10 max-w-5xl w-full items-center justify-start font-mono text-sm flex flex-col mb-auto">
        {initiaAddress ? (
          <div className="flex flex-col space-y-4">
            <button
              onClick={openWallet}
              className="bg-transparent text-black font-bold py-2 px-4 rounded border border-black h-[10vh] flex items-center justify-center"
            >
              {initiaAddress}
            </button>
            <button
              onClick={send}
              disabled={isLoading}
              className="bg-transparent text-black font-bold py-2 px-4 rounded border border-black h-[10vh] flex items-center justify-center disabled:opacity-50"
            >
              {isLoading ? 'Sending...' : 'Send 1 INIT'}
            </button>
            {transactionHash && (
              <p className="text-green-600">
                Transaction successful:{' '}
                <a
                  href={`https://scan.initia.xyz/initiation-2/txs/${transactionHash}`}
                  target="_blank"
                  rel="noopener noreferrer"
                  className="underline"
                >
                  {transactionHash}
                </a>
              </p>
            )}
          </div>
        ) : (
          <button
            onClick={openConnect}
            className="bg-transparent text-black font-bold py-2 px-4 rounded border border-black h-[10vh] flex items-center justify-center"
          >
            Connect
          </button>
        )}
      </div>
    </main>
);
```

The final `src/app/layout.tsx`, `src/app/page.tsx` and `src/components/Providers.tsx` file should look like the following:

<CodeGroup>
```tsx src/app/page.tsx
"use client";

import { useInterwovenKit } from "@initia/interwovenkit-react";
import { MsgSend } from "cosmjs-types/cosmos/bank/v1beta1/tx";
import { useState } from "react";

export default function Home() {
  const { initiaAddress, openConnect, openWallet, requestTxBlock } =
    useInterwovenKit();
  const [isLoading, setIsLoading] = useState(false);
  const [transactionHash, setTransactionHash] = useState<string | null>(null);

  const send = async () => {
    if (!initiaAddress) return;

    setIsLoading(true);

    // create the MsgSend
    const messages = [
      {
        typeUrl: "/cosmos.bank.v1beta1.MsgSend",
        value: MsgSend.fromPartial({
          fromAddress: initiaAddress,
          toAddress: initiaAddress,
          amount: [{ amount: "1000000", denom: "uinit" }],
        }),
      },
    ];

    try {
      // sign and broadcast tx
      const { transactionHash: hash } = await requestTxBlock({
        messages,
        memo: "Hello world!",
      });
      setTransactionHash(hash);
      console.log("Transaction successful: ", hash);
    } catch (error) {
      console.error("Transaction failed: ", error);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <main className="flex min-h-screen flex-col items-center p-24 bg-white">
      <div className="z-10 max-w-5xl w-full items-center justify-start font-mono text-sm flex flex-col mb-auto">
        {initiaAddress ? (
          <div className="flex flex-col space-y-4">
            <button
              onClick={openWallet}
              className="bg-transparent text-black font-bold py-2 px-4 rounded border border-black h-[10vh] flex items-center justify-center"
            >
              {initiaAddress}
            </button>
            <button
              onClick={send}
              disabled={isLoading}
              className="bg-transparent text-black font-bold py-2 px-4 rounded border border-black h-[10vh] flex items-center justify-center disabled:opacity-50"
            >
              {isLoading ? "Sending..." : "Send 1 INIT"}
            </button>
            {transactionHash && (
              <p className="text-green-600">
                Transaction successful:{" "}
                <a
                  href={`https://scan.initia.xyz/initiation-2/txs/${transactionHash}`}
                  target="_blank"
                  rel="noopener noreferrer"
                  className="underline"
                >
                  {transactionHash}
                </a>
              </p>
            )}
          </div>
        ) : (
          <button
            onClick={openConnect}
            className="bg-transparent text-black font-bold py-2 px-4 rounded border border-black h-[10vh] flex items-center justify-center"
          >
            Connect
          </button>
        )}
      </div>
    </main>
  );
}
```
```tsx src/app/layout.tsx
import type { Metadata } from "next";
import Providers from "../components/Providers";

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  return (
    <html lang="en">
      <body>
        <Providers>{children}</Providers>
      </body>
    </html>
  );
}

```
```tsx src/components/Providers.tsx
"use client"; // this is needed to make this a client component

import { useEffect, type PropsWithChildren } from "react";
// import the required dependencies
import { createConfig, http, WagmiProvider } from "wagmi";
import { mainnet } from "wagmi/chains";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { injectStyles, InterwovenKitProvider } from "@initia/interwovenkit-react";
import initiaWidgetStyles from "@initia/interwovenkit-react/styles.js";

// initialize wagmi and react-query
const wagmiConfig = createConfig({
  chains: [mainnet],
  transports: { [mainnet.id]: http() },
});
const queryClient = new QueryClient();

export default function Providers({ children }: PropsWithChildren) {
  // inject CSS styles for Initia Widget
  useEffect(() => {
    injectStyles(initiaWidgetStyles);
  }, []);

  // wrap your app with all the providers
  return (
    <WagmiProvider config={wagmiConfig}>
      <QueryClientProvider client={queryClient}>
        <InterwovenKitProvider>{children}</InterwovenKitProvider>
      </QueryClientProvider>
    </WagmiProvider>
  );
}
```
```ts next.config.ts
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  reactStrictMode: true,
};

export default nextConfig;
```
</CodeGroup>

You can then run the project with `npm run dev` and navigate to `http://localhost:3000` to see the project in action. If everything is working correctly, you should see an interface similar to the following:

<Frame>
![Initia Wallet Widget](/images/wallet-widget/wallet_widget_connect.png)
</Frame>

Clicking on "Connect" will open the wallet selector


<Frame>
![Initia Wallet Widget](/images/wallet-widget/wallet_widget_wallets.png)
</Frame>

Once a wallet is connected, clicking on "Send 1 INIT" will send a transaction to the wallet.

<Frame>
![Initia Wallet Widget](/images/wallet-widget/wallet_widget_connected.png)
</Frame>

Once the transaction is sent, the transaction hash will be displayed in the interface.

<Frame>
![Initia Wallet Widget](/images/wallet-widget/wallet_widget_success.png)
</Frame>

And that's it! You have successfully integrated the Initia Wallet Widget into your NextJS project. You can further extend this example in various ways, such as:

- Showing the user's INIT balance when the wallet is connected.
- Preventing the user from sending transactions if they do not have enough INIT balance.
- Allowing users to specify the amount of INIT to send and the destination address

and more.
