---
title: Migrating to v2
---

## Migration Steps

Follow these steps to update your code from v1 (`@initia/react-wallet-widget`) to v2 (`@initia/interwovenkit-react`).

<Steps>
  <Step title="Install and Imports">
    Change the package name and update imports.

    ```diff
    - pnpm add @initia/react-wallet-widget
    + pnpm add @initia/interwovenkit-react
    ```

    All imports from `@initia/react-wallet-widget` must now come from `@initia/interwovenkit-react`.
  </Step>
  <Step title="Remove SSR Helpers">
    Remove server-side rendering helpers and CDN scripts.

    ```diff
    - import { ssrHelpers } from "@initia/react-wallet-widget/ssr"
    - ssrHelpers.injectScripts()
    ```
  </Step>
  <Step title="Install Peer Dependencies">
    Install the required peer dependencies:

    ```bash
    pnpm add wagmi viem @tanstack/react-query
    ```
  </Step>
  <Step title="Provider Setup">
    ```tsx
    // providers.tsx
    "use client"

    import { PropsWithChildren, useEffect } from "react"
    import { createConfig, http, WagmiProvider } from "wagmi"
    import { mainnet } from "wagmi/chains"
    import { QueryClient, QueryClientProvider } from "@tanstack/react-query"
    import { initiaPrivyWalletConnector, injectStyles, InterwovenKitProvider } from "@initia/interwovenkit-react"
    import InterwovenKitStyles from "@initia/interwovenkit-react/styles.js"

    const wagmiConfig = createConfig({
      connectors: [initiaPrivyWalletConnector],
      chains: [mainnet],
      transports: { [mainnet.id]: http() },
    })
    const queryClient = new QueryClient()

    export default function Providers({ children }: PropsWithChildren) {
      useEffect(() => {
        // Inject styles into the shadow DOM used by Initia Wallet
        injectStyles(InterwovenKitStyles)
      }, [])

      return (
        <QueryClientProvider client={queryClient}>
          <WagmiProvider config={wagmiConfig}>
            <InterwovenKitProvider defaultChainId="YOUR_CHAIN_ID">{children}</InterwovenKitProvider>
          </WagmiProvider>
        </QueryClientProvider>
      )
    }
    ```
  </Step>
</Steps>

## Provider API Changes

Replace `<WalletWidgetProvider>` with `<InterwovenKitProvider>`:

```diff
- <WalletWidgetProvider chainId="interwoven-1" />
+ <InterwovenKitProvider defaultChainId="interwoven-1" />
```

```diff
- <WalletWidgetProvider customLayer={chain} />
+ <InterwovenKitProvider customChain={chain} />
```

Default bridge options have moved to the `openBridge` method:

```tsx
// v1
import { createRoot } from "react-dom/client"

export default function Providers() {
  return <WalletWidgetProvider bridgeOptions={{ defaultDstChainId: "interwoven-1", defaultDstAssetDenom: "uinit" }} />
}
```

```tsx
// v2
import { InterwovenKitProvider, useInterwovenKit } from "@initia/interwovenkit-react"

export default function Home() {
  const { openBridge } = useInterwovenKit()

  return (
    <button onClick={() => openBridge({ dstChainId: "interwoven-1", dstDenom: "uinit" })}>
      Bridge
    </button>
  )
}
```

`<InterwovenKitProvider>` no longer supports:

```diff
- <WalletWidgetProvider additionalWallets />
- <WalletWidgetProvider filterWallet />
```

<Info>
  To customize wallets, use wagmi connectors (see https://wagmi.sh/react/api/connectors).
</Info>

## Core Hooks & Methods

### Wallet Connection UI

```tsx
// v1
import { truncate } from "@initia/utils"
import { useWallet } from "@initia/react-wallet-widget"

export default function Home() {
  const { address, onboard, view, bridge, isLoading } = useWallet()

  if (!address) {
    return (
      <button onClick={onboard} disabled={isLoading}>
        {isLoading ? "Loading..." : "Connect"}
      </button>
    )
  }

  return (
    <>
      <button onClick={bridge}>Bridge</button>
      <button onClick={view}>{truncate(address)}</button>
    </>
  )
}
```

```tsx
// v2
import { truncate } from "@initia/utils"
import { useInterwovenKit } from "@initia/interwovenkit-react"

export default function Home() {
  const { address, openConnect, openWallet, openBridge } = useInterwovenKit()

  if (!address) {
    return <button onClick={openConnect}>Connect</button>
  }

  return (
    <>
      <button onClick={openBridge}>Bridge</button>
      <button onClick={openWallet}>{truncate(address)}</button>
    </>
  )
}
```

```tsx
<Warning>
  Ensure your app is wrapped in <InterwovenKitProvider> at the root
</Warning>
```

### Requesting a Transaction

```tsx
// v1
import { useWallet } from "@initia/react-wallet-widget"

export default function Home() {
  const { requestTx } = useWallet()

  const send = async () => {
    const transactionHash = await requestTx({ messages: [] }, { chainId: "interwoven-1" })
    console.log(transactionHash)
  }

  return <button onClick={send}>Submit</button>
}
```

```tsx
// v2
import { useInterwovenKit } from "@initia/interwovenkit-react"

export default function Home() {
  const { requestTxBlock } = useInterwovenKit()

  const send = async () => {
    const { transactionHash } = await requestTxBlock({ messages: [], chainId: "interwoven-1" })
    console.log(transactionHash)
  }

  return <button onClick={send}>Submit</button>
}
```

```tsx
<Info>
  To first get the transaction hash before chain inclusion and later poll for confirmation, combine `requestTxSync()` with `waitForTxConfirmation()`. (See [Basic Example](./getting-started#basic-example))
</Info>
```

## Interoperability with `@initia/initia.js`

Use helpers to build message objects:

```tsx
import { MsgSend, Msg } from "@initia/initia.js"

function toEncodeObject(msg: Msg) {
  const data = msg.toData()
  return { typeUrl: data["@type"], value: msg.toProto() }
}

// Example usage
export default function Home() {
  const { initiaAddress, requestTxBlock } = useInterwovenKit()

  const mutate = async () => {
    const msgs = [
      MsgSend.fromProto({
        fromAddress: initiaAddress,
        toAddress: initiaAddress,
        amount: [{ amount: "1000000", denom: "uinit" }],
      }),
    ]

    const messages = msgs.map(toEncodeObject)
    const { transactionHash } = await requestTxBlock({ messages, chainId: "interwoven-1" })
    console.log(transactionHash)
  }

  return <button onClick={mutate}>Send</button>
}
```